scripted_gui = {

	# The button to acutally open up the UI
	open_the_un_scripted_gui = {
		context_type = player_context
		window_name = "UN_open_the_un_scripted_gui_window"

		dirty = global.UN_dirty_update_var

		visible = {
			#NOT = { has_global_flag = GAME_RULE_eu_disabled }
			is_ai = no
		}

		triggers = { open_the_un_gui_click_enabled = { is_ai = no } }

		effects = {
			open_the_un_gui_click = {
				UN_screen_selection = yes
				if = { limit = { NOT = { has_country_flag = new_UN_open } }
					set_country_flag = new_UN_open
				}
				else = {
					clr_country_flag = new_UN_open
				}
				set_country_flag = UN_members_page
				update_UN_dirty_variable = yes
			}
		}

		# Bums the Missile GUI one for now
		properties = {
			open_the_un_gui = {
				x = global.var_missiles_button_x
			}
		}
	}

	united_nations_gui = {
		context_type = player_context
		window_name = "UN_main_background_window"
		dirty = global.UN_dirty_update_var

		visible = {
			#NOT = { has_global_flag = GAME_RULE_eu_disabled }
			OR = {
				is_ai = yes
				has_country_flag = new_UN_open
			}
		}

		# AI Triggering Section
		# ai_enabled = Allowed for the AI
		# ai_check = Ensures they are in the EU before opening the GUI
		ai_enabled = { NOT = { has_global_flag = GAME_RULE_eu_disabled } }
		ai_check = {
			always = no
			#OR = {
			#	has_idea = superpower
			#	has_idea = great_power
			#	is_in_array = { global.EU_member = THIS.id }
			#}
		}
		# Test Interval
		ai_test_interval = 24
		ai_max_weight_taken_per_test = 1

		properties = {
			UN_permanent_seat_1 = { image = "[?global.eucouncil.GetFlag]" }
			UN_permanent_seat_2 = { image = "[?global.eucomission.GetFlag]" }
			UN_permanent_seat_3 = { image = "[?global.eucentralbank.GetFlag]" }
			UN_permanent_seat_4 = { image = "[?global.euforeignaffairs.GetFlag]" }
			UN_permanent_seat_5 = { image = "[?global.euparliamentpresident.GetFlag]" }
			UN_president = { image = "[?global.eufinance.GetFlag]" }
			UN_minor_seat_1 = { image = "[?global.eufrontex.GetFlag]" }
			UN_minor_seat_2 = { image = "[?global.euarmy.GetFlag]" }
			UN_minor_seat_3 = { image = "[?global.eunavy.GetFlag]" }
			UN_minor_seat_4 = { image = "[?global.euambassador.GetFlag]" }
			UN_minor_seat_5 = { image = "[?global.eupresfederation.GetFlag]" }
			UN_minor_seat_6 = { image = "[?global.eupresfederation.GetFlag]" }
		}

		triggers = {
			# Main Screen Buttons
				# 
				UN_members_button_click_enabled = {
					has_country_flag = UN_members_page
					#has_idea = UN_member
				}
				UN_member_election_button_click_enabled = {
					has_country_flag = UN_elections_page
					#has_idea = UN_member
				}
				# 
				EU_step_down_click_enabled = {
					OR = {
						has_idea = EU_commission_president
						has_idea = EU_council_president
						has_idea = EU_foreign_minister
						has_idea = EU_parliament_president
						has_idea = ECB_president
						has_idea = EU_finance_minister
						has_idea = frontex_ExDir
						has_idea = EUU_euronavy_sc
						has_idea = EUU_euroarmy_sc
						has_idea = EUU_ambassador_unsc
						has_idea = EU_president
					}
					has_idea = EU_member
				}
				EU_step_down_visible = {
					UN_members_trigger = yes
					#has_idea = EU_member
				}
				eu_president_council_visible = {
					UN_members_trigger = yes
				}
				un_president_council_back_visible = {
					UN_members_trigger = yes
				}
				eu_president_council_text_visible = {
					UN_members_trigger = yes
				}
				foreign_affairs_security_visible = {
					UN_members_trigger = yes
				}
				UN_emergency_meeting_click_enabled = {
					always = yes
					NOT = { 
						has_country_flag = UN_emergency_meeting_called 
						is_ai = no
					}
				}
		}

		effects = {
			# Opens the main screen
			UN_members_button_click = {
				UN_screen_selection = yes
				set_country_flag = UN_members_page
			}

			# Opens the Member Election Screen
			UN_member_election_button_click = {
				UN_screen_selection = yes
				set_country_flag = UN_elections_page
			}
			
			# Call an Emergency Meeting in Response to International Actions
			UN_trigger_emergency_session_click = {
				#activate_mission = EU_exit
				set_country_flag = UN_emergency_meeting_called
				news_event = { id = spm_events.1 }
				update_UN_dirty_variable = yes
			}

			# Offices Screen
			eu_president_council_back_click = {
				add_timed_idea = { idea = EU_council_president days = 1825 }
				for_each_scope_loop = {
					array = global.EU_member
					news_event = EU_news.3
				}
				update_eu_dirty_variable = yes
			}

			# Closes the UI
			un_close_button_click = {
				UN_screen_selection = yes
				clr_country_flag = new_UN_open
				update_UN_dirty_variable = yes
			}

			# European Parliament

			# Voting Buttons
		}

		# TODO: ai weights
	}

}
