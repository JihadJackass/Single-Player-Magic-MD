#########################################
### Effect of clearing broken votings ###
#########################################
update_UN_dirty_variable = {
	if = { limit = { check_variable = { global.UN_dirty_update_var < 10000 } }
		add_to_variable = { global.UN_dirty_update_var = 1 }
	}
	else = {
		set_variable = { global.UN_dirty_update_var = 1 }
	}
}
UN_screen_selection = {
	clr_country_flag = UN_members_page # MEMBERS
	clr_country_flag = UN_elections_page # ELECTIONS
	clr_country_flag = UN_resolutions_page # RESOLUTIONS
	clr_country_flag = UN_unrepresented_page # UNREPRESENTED
	clr_country_flag = UN_coalition_page # COALITION
	update_UN_dirty_variable = yes
}

# EU Startup Configuration
on_startup_unn_action = {
	# TODO: game settings
	if = {
		limit = {
			has_game_rule = {
				rule = rule_disable_eu
				option = yes
			}
		}
		every_country = {
			limit = { has_idea = EU_member }
			remove_ideas = {
				the_euro
				EU_member
				foreign_data_kraken
				asylum_shopping
			}
		}
		set_global_flag = GAME_RULE_eu_disabled
	}

	# Configure European Union startup values and information
	if = { limit = { NOT = { has_global_flag = GAME_RULE_eu_disabled } }
		UNN = {
			add_to_array = { global.EU_potential_votes = 002 } # European Candidate
			add_to_array = { global.EU_potential_votes = 101 } # Charter of Fundamental Rights of the EU
			add_to_array = { global.EU_potential_votes = 102 } # European Convention
			add_to_array = { global.EU_potential_votes = 103 } # European Constitution
			add_to_array = { global.EU_potential_votes = 104 } # Treaty of Lisbon
			add_to_array = { global.EU_potential_votes = 105 } # European External Action Service
			add_to_array = { global.EU_potential_votes = 201 } # ECB Intervention
			add_to_array = { global.EU_potential_votes = 202 } # European Banking Union
			add_to_array = { global.EU_potential_votes = 203 } # Eurobonds
			add_to_array = { global.EU_potential_votes = 204 } # European Financial Stability Facility (EFSF)
			add_to_array = { global.EU_potential_votes = 205 } # European Stability Mechanism (ESM)
			add_to_array = { global.EU_potential_votes = 206 } # Fiscal Union
			add_to_array = { global.EU_potential_votes = 207 } # European Economic Government
			add_to_array = { global.EU_potential_votes = 208 } # European Minister of Economy and Finance
			add_to_array = { global.EU_potential_votes = 301 } # European Defence Agency (EDA)
			add_to_array = { global.EU_potential_votes = 302 } # Permanent Structured Cooperation (PESCO)
			add_to_array = { global.EU_potential_votes = 303 } # European Defence Fund
			add_to_array = { global.EU_potential_votes = 304 } # European Security Council
			add_to_array = { global.EU_potential_votes = 305 } # EuroArmy
			add_to_array = { global.EU_potential_votes = 306 } # EuroNavy
			add_to_array = { global.EU_potential_votes = 307 } # EU Permanent Member of the UNSC
			add_to_array = { global.EU_potential_votes = 308 } # EU Nuclear Power
			add_to_array = { global.EU_potential_votes = 401 } # General Data Protection Regulation
			add_to_array = { global.EU_potential_votes = 402 } # Directive on Copyright in the Digital Single Market
			add_to_array = { global.EU_potential_votes = 403 } # Dublin II Regulations
			add_to_array = { global.EU_potential_votes = 404 } # Relocation and Resettlement of Asylum Seekers
			add_to_array = { global.EU_potential_votes = 405 } # EU-Turkey Deal
			add_to_array = { global.EU_potential_votes = 406 } # European Asylum Agency
			add_to_array = { global.EU_potential_votes = 407 } # Frontex
			add_to_array = { global.EU_potential_votes = 408 } # European Border & Coast Guard Agency
			add_to_array = { global.EU_potential_votes = 601 } # 2004 EU Enlargement
			add_to_array = { global.EU_potential_votes = 602 } # 2007 EU Enlargement
			add_to_array = { global.EU_potential_votes = 603 } # 2013 EU Enlargement
			add_to_array = { global.EU_potential_votes = 605 } # Western Balkans Enlargement
			add_to_array = { global.EU_potential_votes = 606 } # Turkey
			add_to_array = { global.EU_potential_votes = 607 } # Black Sea Enlargement
			add_to_array = { global.EU_potential_votes = 608 } # Caucasus Enlargement
			add_to_array = { global.EU_potential_votes = 609 } # European Economic Area
			add_to_array = { global.EU_potential_votes = 610 } # Belarus
			add_to_array = { global.EU_potential_votes = 611 } # Internal Enlargement
			add_to_array = { global.EU_potential_votes = 110 } # Federalisation of the European Union
			add_to_array = { global.EU_potential_votes = 111 } # United States of Europe
			add_to_array = { global.EU_potential_votes = 112 } # European Federation

			#base voting array for pp calcuations
			add_to_array = { array = global.starting_mep_support_parliment value = -100 }
			add_to_array = { array = global.starting_mep_support_parliment value = -50 }
			add_to_array = { array = global.starting_mep_support_parliment value = 0 }
			add_to_array = { array = global.starting_mep_support_parliment value = 50 }
			add_to_array = { array = global.starting_mep_support_parliment value = 100 }

			add_to_array = { global.EU_member = AUS }
			add_to_array = { global.EU_member = BEL }
			add_to_array = { global.EU_member = DEN }
			add_to_array = { global.EU_member = ENG }
			add_to_array = { global.EU_member = FIN }
			add_to_array = { global.EU_member = FRA }
			add_to_array = { global.EU_member = GER }
			add_to_array = { global.EU_member = GRE }
			add_to_array = { global.EU_member = HOL }
			add_to_array = { global.EU_member = IRE }
			add_to_array = { global.EU_member = ITA }
			add_to_array = { global.EU_member = LUX }
			add_to_array = { global.EU_member = POR }
			add_to_array = { global.EU_member = SPR }
			add_to_array = { global.EU_member = SWE }

			add_to_array = { global.EU_potential = ALB }
			add_to_array = { global.EU_potential = ARM }
			add_to_array = { global.EU_potential = AUS }
			add_to_array = { global.EU_potential = AZE }
			add_to_array = { global.EU_potential = BEL }
			add_to_array = { global.EU_potential = BLR }
			add_to_array = { global.EU_potential = BOS }
			add_to_array = { global.EU_potential = BUL }
			add_to_array = { global.EU_potential = CAT }
			add_to_array = { global.EU_potential = CRE }
			add_to_array = { global.EU_potential = CRO }
			add_to_array = { global.EU_potential = CYP }
			add_to_array = { global.EU_potential = CZE }
			add_to_array = { global.EU_potential = DEN }
			add_to_array = { global.EU_potential = ENG }
			add_to_array = { global.EU_potential = EST }
			add_to_array = { global.EU_potential = FIN }
			add_to_array = { global.EU_potential = FRA }
			add_to_array = { global.EU_potential = FYR }
			add_to_array = { global.EU_potential = GEO }
			add_to_array = { global.EU_potential = GER }
			add_to_array = { global.EU_potential = GRE }
			add_to_array = { global.EU_potential = HOL }
			add_to_array = { global.EU_potential = HUN }
			add_to_array = { global.EU_potential = ICE }
			add_to_array = { global.EU_potential = IRE }
			add_to_array = { global.EU_potential = ITA }
			add_to_array = { global.EU_potential = KOS }
			add_to_array = { global.EU_potential = LAT }
			add_to_array = { global.EU_potential = LIT }
			add_to_array = { global.EU_potential = LUX }
			add_to_array = { global.EU_potential = MLT }
			add_to_array = { global.EU_potential = MLV }
			add_to_array = { global.EU_potential = MNT }
			add_to_array = { global.EU_potential = NOR }
			add_to_array = { global.EU_potential = POL }
			add_to_array = { global.EU_potential = POR }
			add_to_array = { global.EU_potential = ROM }
			add_to_array = { global.EU_potential = SCL }
			add_to_array = { global.EU_potential = SCO }
			add_to_array = { global.EU_potential = SER }
			add_to_array = { global.EU_potential = SLO }
			add_to_array = { global.EU_potential = SLV }
			add_to_array = { global.EU_potential = SPR }
			add_to_array = { global.EU_potential = SWE }
			add_to_array = { global.EU_potential = SWI }
			add_to_array = { global.EU_potential = TUR }
			add_to_array = { global.EU_potential = UKR }
			add_to_array = { global.EU_potential = WAS }
			add_to_array = { global.EU_potential = HLS }
			add_to_array = { global.EU_potential = SMA }
			add_to_array = { global.EU_potential = MNC }
			add_to_array = { global.EU_potential = ADO }
			add_to_array = { global.EU_potential = LIC }
			add_to_array = { global.EU_potential = GAL }
			add_to_array = { global.EU_potential = SIL }
			add_to_array = { global.EU_potential = SPA }
			add_to_array = { global.EU_potential = CNR }
			add_to_array = { global.EU_potential = NAV }
			add_to_array = { global.EU_potential = BAY }
			add_to_array = { global.EU_potential = GRL }

			country_event = { id = EUupdate.1 }

			### EU_mff
			EU_update_vars = yes

			every_country = {
				limit = { has_idea = EU_member }
				activate_mission = EU_mff_preparations
				activate_mission = EU_budget_preparations
			}
			set_variable = { global.EU_budget_call_rate = 1.00 }
			set_EU_gdp = yes
			set_EU_total_budget = yes
			update_EU_average_gdp_lvl = yes
			update_EU_average_eco_lvl = yes
			set_EU_expenditure = yes
			distribute_EU_budget = yes
		}

		set_variable = { global.eucouncil = UNN.id }
		set_variable = { global.eucomission = UNN.id }
		set_variable = { global.eucentralbank = UNN.id }
		set_variable = { global.euforeignaffairs = UNN.id }
		set_variable = { global.euparliamentpresident = UNN.id }
		set_variable = { global.eufinance = UNN.id }
		set_variable = { global.eufrontex = UNN.id }
		set_variable = { global.euarmy = UNN.id }
		set_variable = { global.eunavy = UNN.id }
		set_variable = { global.euambassador = UNN.id }
		set_variable = { global.eupresfederation = UNN.id }
	}
	update_UN_dirty_variable = yes
}

UN_clear_voting = {
	every_country = {
		limit = { has_country_flag = UN_potential }
		#clear_variable = global.var_EUvoteYes
		#clear_variable = global.var_EUvoteNo
		#clear_variable = global.var_EUvoteTotal
		#clear_variable = global.var_EUpopYes
		#clear_variable = global.var_EUpopNo
	}
	update_UN_dirty_variable = yes
}

##############################################
##############################################
### EU scripted effects to use for modding ###
##############################################
##############################################

UN_update_vars = {

}
